# 实现计划

- [x] 1. 搭建项目结构和核心接口



  - 创建博客写作服务的目录结构
  - 设置Node.js项目配置和依赖
  - 定义核心数据模型和接口
  - _需求: 1.1, 4.1, 5.1_




- [x] 2. 实现后端API服务




  - [x] 2.1 创建Express服务器基础架构


    - 设置Express应用和中间件

    - 配置静态文件服务
    - 实现基础路由结构


    - _需求: 1.1, 4.1_



  - [x] 2.2 实现博文管理API端点



    - 创建POST /api/posts端点用于发布博文

    - 创建GET /api/posts端点用于获取博文列表


    - 实现文件名生成和冲突处理逻辑
    - _需求: 3.1, 4.1, 4.5_






  - [ ] 2.3 实现草稿管理API端点
    - 创建POST /api/drafts端点用于保存草稿
    - 创建GET /api/drafts/:id端点用于获取草稿
    - 实现草稿的临时存储机制


    - _需求: 1.4, 1.5_

- [ ] 3. 开发封面图片生成系统
  - [x] 3.1 实现Canvas封面生成器


    - 创建基础Canvas绘制功能
    - 实现文字渲染和布局算法
    - 设计默认封面模板样式
    - _需求: 2.1, 2.3_

  - [ ] 3.2 创建多种封面模板
    - 实现技术类博文模板
    - 实现分享类博文模板
    - 实现教程类博文模板
    - _需求: 2.1, 2.3_

  - [ ] 3.3 集成封面生成API
    - 创建POST /api/generate-cover端点
    - 实现封面图片保存到blog-img文件夹
    - 添加备用图片处理机制
    - _需求: 2.2, 2.4, 5.2_

- [ ] 4. 构建博客编辑器界面
  - [ ] 4.1 创建编辑器HTML结构
    - 设计编辑器页面布局
    - 集成现有网站导航和样式
    - 创建标题和内容输入区域
    - _需求: 1.1, 1.2_

  - [ ] 4.2 实现富文本编辑功能
    - 添加文本格式化工具栏
    - 实现Markdown语法支持
    - 创建实时预览功能
    - _需求: 1.2, 1.3_

  - [ ] 4.3 添加草稿保存和发布功能
    - 实现自动保存草稿机制
    - 创建手动保存按钮
    - 实现发布博文功能
    - 添加离开页面警告
    - _需求: 1.4, 1.5_

- [ ] 5. 实现博文文件生成和管理
  - [ ] 5.1 创建博文HTML模板系统
    - 设计博文页面HTML模板
    - 实现模板变量替换功能
    - 确保与现有博文样式一致
    - _需求: 4.1, 4.3_

  - [ ] 5.2 实现博文文件保存功能
    - 创建HTML文件生成逻辑
    - 实现文件保存到blog文件夹
    - 添加文件权限检查
    - _需求: 4.1, 4.2, 4.4_

  - [x] 5.3 开发blog.html自动更新功能


    - 解析现有blog.html结构
    - 实现新博文条目插入逻辑
    - 保持时间顺序排列
    - 确保现有样式和结构不变
    - _需求: 3.1, 3.2, 3.3, 3.4_




- [ ] 6. 实现自动目录生成系统
  - [ ] 6.1 创建标题解析器
    - 实现HTML标题标签识别
    - 创建层级结构分析算法
    - 生成唯一锚点标识符

    - _需求: 6.1, 6.4_

  - [ ] 6.2 构建目录HTML生成器
    - 创建目录HTML结构生成
    - 实现层级缩进显示
    - 添加目录样式和交互
    - _需求: 6.2, 6.4_


  - [ ] 6.3 集成目录到博文模板
    - 将目录嵌入到博文HTML模板
    - 实现左侧固定定位
    - 添加滚动高亮功能
    - 确保无标题时不显示目录
    - _需求: 6.2, 6.5, 6.6, 6.7_

- [ ] 7. 完善用户界面和用户体验
  - [ ] 7.1 优化编辑器界面设计
    - 应用现有网站的CSS变量和样式
    - 实现响应式设计适配
    - 添加深浅模式支持
    - _需求: 1.1, 1.2_

  - [ ] 7.2 添加错误处理和用户反馈
    - 实现表单验证和错误提示
    - 添加操作成功/失败通知
    - 创建加载状态指示器
    - _需求: 1.5, 2.4, 5.5_

  - [ ] 7.3 实现图片上传和管理功能
    - 创建图片上传界面
    - 实现图片保存到blog-img文件夹
    - 添加图片格式验证
    - 生成正确的相对路径引用
    - _需求: 5.1, 5.3, 5.4_

- [ ] 8. 系统集成和测试
  - [ ] 8.1 集成所有组件
    - 连接前端编辑器与后端API
    - 测试完整的博文创建流程
    - 验证文件生成和保存功能
    - _需求: 1.1, 2.1, 3.1, 4.1_

  - [ ] 8.2 进行端到端测试
    - 测试从编辑到发布的完整工作流
    - 验证blog.html更新功能
    - 测试封面图片生成和显示
    - 验证目录生成和导航功能
    - _需求: 2.1, 3.1, 4.1, 6.1_

  - [ ]* 8.3 编写单元测试
    - 为封面生成器编写测试用例
    - 为文件管理功能编写测试
    - 为API端点编写测试
    - _需求: 2.1, 4.1, 5.1_

- [ ] 9. 部署和文档
  - [ ] 9.1 准备生产环境配置
    - 配置生产环境变量
    - 优化静态资源加载
    - 设置错误日志记录
    - _需求: 4.4, 5.5_

  - [ ] 9.2 创建使用说明文档
    - 编写编辑器使用指南
    - 创建功能演示截图
    - 记录常见问题和解决方案
    - _需求: 1.1, 2.1_